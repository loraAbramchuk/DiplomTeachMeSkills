{% extends 'base.html' %}
{% load static %}

{% block title %}Профиль {{ user_profile.username }}{% endblock %}

{% block content %}
<section class="movie-area movie-bg" style="background-image: url(/static/img/bg/movie_bg.jpg);">
    <div class="container py-5">
        <div class="row mb-4">
            <div class="col-12">
                <div class="section-title text-center text-lg-left">
                    <span class="sub-title">ПРОФИЛЬ</span>
                    <h2 class="title">{{ user_profile.username }}</h2>
                </div>
            </div>
        </div>

        <!-- Подписки -->
        <div class="row mb-50">
            <div class="col-12">
                <div class="widget-title mb-30">
                    <h5 class="title">Подписки</h5>
                </div>
                {% if user_subscription %}
                    <div class="services-content-wrap">
                        <div class="movie-content mb-30">
                            <div class="top">
                                <h5 class="title">{{ user_subscription.subscription.name }}</h5>
                                <span class="date">до {{ user_subscription.end_date|date:"d.m.Y H:i" }}</span>
                            </div>
                            {% if user_subscription.auto_renewal %}
                                <p class="text">Включено автопродление</p>
                            {% else %}
                                <p class="text">Автопродление отключено</p>
                            {% endif %}
                        </div>
                    </div>
                {% else %}
                    <div class="services-content-wrap">
                        <div class="movie-content mb-30">
                            <p class="text">Нет активных подписок. <a href="{% url 'subscription_list' %}" class="btn">Оформить подписку</a></p>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="widget-title mb-50">
                    <h5 class="title">Рецензии пользователя</h5>
                </div>
                
                <!-- Рецензии на фильмы -->
                <div class="widget-title mt-4 mb-30">
                    <h5 class="title">Рецензии на фильмы</h5>
                </div>
                {% for review in movie_reviews %}
                    <div class="ucm-area-content">
                        <div class="movie-content mb-30">
                            <div class="top">
                                <h5 class="title">
                                    <a href="{% url 'movie_detail' review.movie.pk %}">{{ review.movie.title }}</a>
                                </h5>
                                <span class="date">Оценка: {{ review.rating }}/10</span>
                            </div>
                            <p class="text">{{ review.text }}</p>
                            <div class="bottom">
                                <ul>
                                    <li><span class="date"><i class="far fa-clock"></i> {{ review.created_at|date:"d.m.Y H:i" }}</span></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                {% empty %}
                    <p class="text">Пользователь еще не оставил рецензий на фильмы.</p>
                {% endfor %}

                <!-- Рецензии на сериалы -->
                <div class="widget-title mt-4 mb-30">
                    <h5 class="title">Рецензии на сериалы</h5>
                </div>
                {% for review in serial_reviews %}
                    <div class="ucm-area-content">
                        <div class="movie-content mb-30">
                            <div class="top">
                                <h5 class="title">
                                    <a href="{% url 'serial_detail' review.serial.pk %}">{{ review.serial.title }}</a>
                                </h5>
                                <span class="date">Оценка: {{ review.rating }}/10</span>
                            </div>
                            <p class="text">{{ review.text }}</p>
                            <div class="bottom">
                                <ul>
                                    <li><span class="date"><i class="far fa-clock"></i> {{ review.created_at|date:"d.m.Y H:i" }}</span></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                {% empty %}
                    <p class="text">Пользователь еще не оставил рецензий на сериалы.</p>
                {% endfor %}
            </div>
        </div>
    </div>
</section>
{% endblock %} 